<script>
    const audioPlayer = document.getElementById('audio-player');
    const audioContainer = document.getElementById('audio-controls-container');
    const speedDisplay = document.getElementById('speed-display');
    
    let currentActiveItem = null;

    // BASE URL для "сирих" файлів у репозиторії Audio_Assetss
    // ПЕРЕВІРТЕ: 'main' чи 'master'
    const BASE_AUDIO_URL = 'https://raw.githubusercontent.com/shylovak-spec/Audio_Assetss/main/';

    // Ініціалізація обробників подій для елементів списку
    document.querySelectorAll('#instruction-list li[data-file]').forEach(item => {
        item.addEventListener('click', function() {
            loadAndPlay(this.getAttribute('data-file'), this);
        });
    });

    function loadAndPlay(fileName, listItem) {
        // Формування повного Raw URL-адреси
        const mp3Src = `${BASE_AUDIO_URL}${fileName}.mp3`;
        const oggSrc = `${BASE_AUDIO_URL}${fileName}.ogg`;

        // Логіка паузи/відновлення
        if (currentActiveItem === listItem && !audioPlayer.paused) {
            audioPlayer.pause();
            currentActiveItem.classList.remove('active-instruction');
            currentActiveItem = null;
            audioContainer.style.display = 'none';
            return;
        }

        // Зупинка попереднього відтворення
        if (currentActiveItem) {
            currentActiveItem.classList.remove('active-instruction');
            audioPlayer.pause();
            audioPlayer.currentTime = 0;
        }

        // Встановлення нового активного елемента
        currentActiveItem = listItem;
        currentActiveItem.classList.add('active-instruction');
        audioContainer.style.display = 'block';
        
        // Вставка джерел аудіо в плеєр
        audioPlayer.innerHTML = `
            <source src="${mp3Src}" type="audio/mpeg">
            <source src="${oggSrc}" type="audio/ogg">
            Ваш браузер не підтримує аудіоформати MP3 чи OGG.
        `;

        audioPlayer.playbackRate = 1.0;
        speedDisplay.textContent = '1.00';
        
        audioPlayer.load();
        audioPlayer.play();

        // Логіка після завершення відтворення
        audioPlayer.onended = function() {
            if (currentActiveItem) {
                currentActiveItem.classList.remove('active-instruction');
                currentActiveItem = null;
                audioContainer.style.display = 'none';
            }
        };
    }

    // Функція регулювання швидкості
    // (Припускаємо, що кнопки +/- викликають adjustSpeed(-0.25) та adjustSpeed(0.25))
    function adjustSpeed(delta) {
        let currentSpeed = Math.round(audioPlayer.playbackRate * 100) / 100;
        let newSpeed = currentSpeed + delta;

        // Обмеження швидкості
        if (newSpeed < 1.0) {
            newSpeed = 1.0;
        }
        if (newSpeed > 2.0) {
            newSpeed = 2.0;
        }

        audioPlayer.playbackRate = newSpeed;
        speedDisplay.textContent = newSpeed.toFixed(2);
    }
</script>
