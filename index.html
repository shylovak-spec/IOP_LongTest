<script>
    const audioPlayer = document.getElementById('audio-player');
    const audioContainer = document.getElementById('audio-controls-container');
    const speedDisplay = document.getElementById('speed-display');
    const instructionList = document.getElementById('instruction-list');
    
    let currentActiveItem = null;

    // Базовий URL для "сирих" файлів у репозиторії Audio_Assetss
    // ВАЖЛИВО: 'main' - це назва вашої головної гілки. Якщо вона називається 'master', замініть 'main' на 'master'.
    const BASE_AUDIO_URL = 'https://raw.githubusercontent.com/shylovak-spec/Audio_Assetss/main/';

    document.querySelectorAll('#instruction-list li[data-file]').forEach(item => {
        item.addEventListener('click', function() {
            loadAndPlay(this.getAttribute('data-file'), this);
        });
    });

    function loadAndPlay(fileName, listItem) {
        // Тепер шляхи формуються з використанням BASE_AUDIO_URL
        const mp3Src = `${BASE_AUDIO_URL}${fileName}.mp3`;
        const oggSrc = `${BASE_AUDIO_URL}${fileName}.ogg`;

        if (currentActiveItem === listItem && !audioPlayer.paused) {
            audioPlayer.pause();
            currentActiveItem.classList.remove('active-instruction');
            currentActiveItem = null;
            audioContainer.style.display = 'none';
            return;
        }

        if (currentActiveItem) {
            currentActiveItem.classList.remove('active-instruction');
            audioPlayer.pause();
            audioPlayer.currentTime = 0;
        }

        currentActiveItem = listItem;
        currentActiveItem.classList.add('active-instruction');
        audioContainer.style.display = 'block';
        
        audioPlayer.innerHTML = '';
        
        audioPlayer.innerHTML = `
            <source src="${mp3Src}" type="audio/mpeg">
            <source src="${oggSrc}" type="audio/ogg">
            Ваш браузер не підтримує аудіоформати MP3 чи OGG.
        `;

        audioPlayer.playbackRate = 1.0;
        speedDisplay.textContent = '1.00';
        
        audioPlayer.load();
        audioPlayer.play();

        audioPlayer.onended = function() {
            if (currentActiveItem) {
                currentActiveItem.classList.remove('active-instruction');
                currentActiveItem = null;
                audioContainer.style.display = 'none';
            }
        };
    }

    function adjustSpeed(delta) {
        let currentSpeed = Math.round(audioPlayer.playbackRate * 100) / 100;
        let newSpeed = currentSpeed + delta;

        if (newSpeed < 1.0) {
            newSpeed = 1.0;
        }
        if (newSpeed > 2.0) {
            newSpeed = 2.0;
        }

        audioPlayer.playbackRate = newSpeed;
        speedDisplay.textContent = newSpeed.toFixed(2);
    }
</script>
